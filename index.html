<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å­«å­ï¼šè¬€ç•¥ä¹‹æˆ° v5.0 (è»ç‡Ÿæˆ°åœ°ç‰ˆ)</title>
    <style>
        :root {
            /* è»ç‡Ÿé…è‰² */
            --bg-camp: #e6e2d3; /* å¸†å¸ƒ/è»å¸³è‰² */
            --wood-dark: #3e2723; /* æ·±æœ¨é ­ */
            --wood-light: #5d4037; 
            --bamboo-light: #ffecb3;
            --bamboo-dark: #ffca28;
            --accent-red: #b71c1c; /* å¸¥å°ç´… */
            --success-green: #2e7d32;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", serif;
            margin: 0;
            padding: 0;
            background-color: #d7ccc8; /* èƒŒæ™¯åŠ æ·± */
            background-image: repeating-linear-gradient(45deg, #d7ccc8 25%, #d7ccc8 50%, #cfd8dc 50%, #cfd8dc 75%); /* å¢åŠ ä¸€é»ç´‹ç† */
            background-size: 20px 20px;
            color: var(--wood-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh; /* å›ºå®šé«˜åº¦ï¼Œé˜²æ­¢æ•´å€‹é é¢æ»¾å‹• */
            overflow: hidden; /* ç¦æ­¢æ•´å€‹é é¢æ»¾å‹• */
        }

        /* === é ‚éƒ¨è»å¸³é¢¨æ ¼ Header === */
        header {
            width: 100%;
            background: var(--bg-camp);
            padding: 10px 0 15px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            position: relative;
            z-index: 10;
            border-bottom: 5px solid var(--wood-dark);
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
        }

        /* è£é£¾ï¼šè»å¸³é ‚éƒ¨çš„ä¸‰è§’å½¢ */
        header::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 10px;
            background: linear-gradient(45deg, var(--wood-dark) 25%, transparent 25%) -10px 0,
                        linear-gradient(-45deg, var(--wood-dark) 25%, transparent 25%) -10px 0;
            background-size: 20px 20px;
        }

        h1 {
            font-size: 1.5rem;
            margin: 0;
            text-align: center;
            color: var(--wood-dark);
            text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
            letter-spacing: 2px;
        }

        .header-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 500px;
            margin: 10px auto 0;
        }

        .level-tag {
            background: var(--wood-dark);
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* Switch Toggle */
        .switch-container {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: var(--wood-dark);
            gap: 5px;
            font-weight: bold;
        }
        .switch-input { display: none; }
        .switch-track {
            width: 40px;
            height: 22px;
            background-color: #aaa;
            border-radius: 20px;
            position: relative;
            transition: 0.3s;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
        }
        .switch-knob {
            width: 18px;
            height: 18px;
            background-color: #fff;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .switch-input:checked + .switch-track { background-color: var(--accent-red); }
        .switch-input:checked + .switch-track .switch-knob { transform: translateX(18px); }

        /* é€²åº¦æ¢ */
        .progress-bar {
            width: 90%;
            height: 6px;
            background: #bbb;
            margin: 8px auto 0;
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid #999;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent-red);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* === éŠæˆ²ä¸»å€åŸŸ (Flex ä½ˆå±€) === */
        #game-container {
            flex-grow: 1; /* ä½”æ»¿å‰©é¤˜ç©ºé–“ */
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            padding: 10px;
            box-sizing: border-box;
            overflow: hidden; /* é˜²æ­¢æº¢å‡º */
        }

        /* NPC å°è©±æ¡† */
        .npc-area {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-shrink: 0; /* å›ºå®šé«˜åº¦ */
        }
        .npc-avatar {
            width: 50px;
            height: 50px;
            background: var(--wood-dark);
            color: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            border: 3px solid #bcaaa4;
            box-shadow: 0 4px 4px rgba(0,0,0,0.3);
        }
        .npc-text {
            background: #fff;
            padding: 10px 15px;
            border-radius: 15px;
            border: 2px solid var(--wood-dark);
            font-size: 0.95rem;
            line-height: 1.4;
            flex: 1;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            position: relative;
        }
        .npc-text::after { /* å°è©±æ¡†å°ç®­é ­ */
            content: '';
            position: absolute;
            left: -8px;
            top: 15px;
            border-width: 8px 8px 8px 0;
            border-style: solid;
            border-color: transparent var(--wood-dark) transparent transparent;
        }

        /* === 1. ä¸Šæ–¹æ”¾ç½®å€ (è§£æ±ºç„¡é™æ‹‰é•·å•é¡Œ) === */
        .target-zone-wrapper {
            flex-grow: 1; /* åƒæ‰ä¸­é–“æ‰€æœ‰ç©ºé–“ */
            background: #fdfbf7;
            border: 6px solid var(--wood-dark);
            border-radius: 8px;
            margin-bottom: 10px;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1), 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden; /* é—œéµï¼šè®“å…§éƒ¨å¯ä»¥æ»¾å‹• */
        }

        .scroll-board {
            padding: 15px;
            overflow-y: auto; /* é—œéµï¼šå…§å®¹å¤šæ™‚ï¼Œé€™è£¡å‡ºç¾å·è»¸ */
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .hint-text {
            color: #999;
            margin-top: 20px;
            font-weight: bold;
            pointer-events: none;
        }

        /* === 2. ä¸‹æ–¹å€™é¸å€ (å›ºå®šåœ¨åº•éƒ¨) === */
        .source-zone-wrapper {
            flex-shrink: 0; /* ä¸è¢«å£“ç¸® */
            background: rgba(255,255,255,0.4);
            border-top: 2px dashed var(--wood-dark);
            padding: 10px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .section-label {
            font-size: 0.9rem;
            color: var(--wood-dark);
            margin-bottom: 5px;
            font-weight: bold;
            background: rgba(255,255,255,0.8);
            padding: 2px 10px;
            border-radius: 10px;
        }

        .options-board {
            width: 100%;
            display: flex;
            flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
            justify-content: center;
            gap: 10px;
            min-height: 80px; /* ç¢ºä¿æœ‰ç©ºé–“ */
        }

        /* === 3. ç«¹ç°¡æ¨£å¼ (è»ç‡Ÿç«‹é«”é¢¨) === */
        .bamboo-slip {
            /* æ¼¸å±¤æ‰“é€ ç«‹é«”ç«¹å­æ„Ÿ */
            background: linear-gradient(to right, #eecfa1 0%, #d7a566 50%, #eecfa1 100%);
            border: 1px solid #8d6e63;
            border-top: 3px solid #5d4037; /* ç«¹ç¯€é ‚ */
            border-bottom: 3px solid #5d4037; /* ç«¹ç¯€åº• */
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #3e2723;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            text-shadow: 0 1px 0 rgba(255,255,255,0.4);
            
            /* æ§åˆ¶å¤§å°ï¼Œé˜²æ­¢è®Šå½¢ */
            flex: 0 0 auto; /* ä¸æœƒè‡ªå‹•æ”¾å¤§å¡«æ»¿ */
            min-width: 80px;
            text-align: center;
            
            transition: transform 0.1s;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }

        /* è£é£¾ï¼šç«¹ç°¡ä¸Šçš„ç¹©å­ */
        .bamboo-slip::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 5px;
            width: 100%;
            height: 2px;
            background: rgba(62, 39, 35, 0.2);
            z-index: 0;
            pointer-events: none;
        }

        .bamboo-slip:active {
            transform: scale(0.95);
        }

        /* æç¤ºç‰¹æ•ˆ */
        .bamboo-slip.hint-active {
            background: linear-gradient(to right, #fff59d 0%, #fbc02d 50%, #fff59d 100%);
            border-color: #f57f17;
            box-shadow: 0 0 15px #ffeb3b;
            z-index: 2; /* æµ®èµ·ä¾† */
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* æŒ‰éˆ•å€ */
        .action-area {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: center;
            margin-bottom: 5px;
        }

        button {
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 5px rgba(0,0,0,0.2);
            color: white;
            flex: 1;
            max-width: 150px;
        }
        #check-answer-btn {
            background: var(--success-green);
            display: none;
        }
        #reset-btn {
            background: #795548;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .modal-content {
            background: #fdfbf7;
            width: 85%;
            max-width: 400px;
            padding: 20px;
            border-radius: 10px;
            border: 5px solid var(--wood-dark);
            text-align: center;
            position: relative;
        }
        /* è£é£¾ï¼šå°ç«  */
        .stamp {
            position: absolute;
            top: -20px;
            right: -10px;
            width: 60px;
            height: 60px;
            border: 3px solid var(--accent-red);
            border-radius: 5px;
            color: var(--accent-red);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            transform: rotate(15deg);
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        .translation-text {
            text-align: left;
            margin: 20px 0;
            line-height: 1.6;
            color: #333;
            background: #efebe9;
            padding: 10px;
            border-radius: 5px;
        }

    </style>
</head>
<body>

    <header>
        <h1>å­«å­ï¼šè¬€ç•¥ä¹‹æˆ°</h1>
        <div class="header-controls">
            <div class="level-tag" id="level-indicator">è¼‰å…¥ä¸­...</div>
            <label class="switch-container">
                <input type="checkbox" id="hint-toggle" class="switch-input" checked onchange="toggleHint()">
                <div class="switch-track"><div class="switch-knob"></div></div>
                <span>æç¤º</span>
            </label>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progress-bar"></div></div>
    </header>

    <div id="game-container">
        
        <div class="npc-area">
            <div class="npc-avatar">å­«æ­¦</div>
            <div class="npc-text" id="npc-text">ä½ˆé™£ä¸­...</div>
        </div>

        <div class="target-zone-wrapper">
            <div class="scroll-board" id="target-zone">
                <div class="hint-text" id="hint-text">(è«‹é»æ“Šä¸‹æ–¹é–ƒçˆç«¹ç°¡)</div>
            </div>
        </div>

        <div class="action-area">
            <button id="reset-btn" onclick="resetCurrentLevel()">â†º é‡æ•´æ——é¼“</button>
            <button id="check-answer-btn" onclick="showModal()">ğŸ“œ æŸ¥çœ‹è»æ›¸</button>
        </div>

        <div class="source-zone-wrapper">
            <div class="section-label">â–¼ å€™é¸ç«¹ç°¡ â–¼</div>
            <div class="options-board" id="source-zone"></div>
        </div>

    </div>

    <div class="modal" id="win-modal">
        <div class="modal-content">
            <div class="stamp">å®Œå‹</div>
            <h2 style="color: var(--wood-dark); margin-top:10px;">â˜… è¬€ç•¥æ­£ç¢º â˜…</h2>
            <div class="translation-text" id="modal-content"></div>
            <div style="display:flex; gap:10px;">
                <button style="background:#757575;" onclick="replayLevel()">å†æ¬¡æ¼”ç·´</button>
                <button style="background:var(--wood-dark);" onclick="nextLevel()">ä¸‹ä¸€é—œ</button>
            </div>
        </div>
    </div>

    <script>
        window.onload = function() { initGame(); };

        const levels = [
            { segments: ["å…µè€…", "åœ‹ä¹‹å¤§äº‹", "æ­»ç”Ÿä¹‹åœ°", "å­˜äº¡ä¹‹é“", "ä¸å¯ä¸å¯Ÿä¹Ÿ"], translation: "ã€ç™½è©±ã€‘æˆ°çˆ­æ˜¯åœ‹å®¶çš„å¤§äº‹ï¼Œé—œä¿‚åˆ°è»æ°‘çš„ç”Ÿæ­»ï¼Œåœ‹å®¶çš„å­˜äº¡ï¼Œæ˜¯çµ•å°ä¸å¯ä»¥ä¸èªçœŸè€ƒå¯Ÿç ”ç©¶çš„ã€‚", npcWin: "å­«æ­¦ï¼šã€Œä¸éŒ¯ï¼ä¸çŸ¥æ­»ç”Ÿï¼Œä¸é…è¨€å…µã€‚ã€" },
            { segments: ["ä¸€æ›°é“", "äºŒæ›°å¤©", "ä¸‰æ›°åœ°", "å››æ›°å°‡", "äº”æ›°æ³•"], translation: "ã€ç™½è©±ã€‘é€™äº”å€‹æ–¹é¢æ˜¯ï¼šç¬¬ä¸€æ˜¯é“ï¼ˆæ”¿æ²»ï¼‰ï¼Œç¬¬äºŒæ˜¯å¤©ï¼ˆå¤©æ™‚ï¼‰ï¼Œç¬¬ä¸‰æ˜¯åœ°ï¼ˆåœ°åˆ©ï¼‰ï¼Œç¬¬å››æ˜¯å°‡ï¼ˆå°‡é ˜ï¼‰ï¼Œç¬¬äº”æ˜¯æ³•ï¼ˆæ³•åˆ¶ï¼‰ã€‚", npcWin: "å­«æ­¦ï¼šã€Œæ­¤äº”è€…ï¼Œå°‡é ˜ä¸å¯ä¸å¯Ÿã€‚ã€" },
            { segments: ["é“è€…", "ä»¤æ°‘èˆ‡ä¸ŠåŒæ„ä¹Ÿ", "æ•…å¯èˆ‡ä¹‹æ­»", "å¯èˆ‡ä¹‹ç”Ÿ", "è€Œä¸ç•å±"], translation: "ã€ç™½è©±ã€‘æ‰€è¬‚ã€Œé“ã€ï¼Œå°±æ˜¯ä½¿æ°‘çœ¾èˆ‡å›ä¸»çš„æ„é¡˜ä¸€è‡´ã€‚é€™æ¨£ï¼Œæ°‘çœ¾å°±èƒ½èˆ‡å›ä¸»åŒç”Ÿæ­»ã€å…±æ‚£é›£ï¼Œè€Œä¸ç•æ‡¼å±éšªã€‚", npcWin: "å­«æ­¦ï¼šã€Œä¸Šä¸‹åŒæ¬²è€…å‹ï¼Œæ­¤ä¹ƒé“ä¹Ÿã€‚ã€" },
            { segments: ["å¤©è€…", "é™°é™½", "å¯’æš‘", "æ™‚åˆ¶ä¹Ÿ"], translation: "ã€ç™½è©±ã€‘æ‰€è¬‚ã€Œå¤©ã€ï¼Œå°±æ˜¯æŒ‡æ™å¤œé™°é™½çš„è®ŠåŒ–ï¼Œå¯’å†¬æš‘å­£çš„æ›´æ›¿ï¼Œä»¥åŠé©æ–¼ä½œæˆ°çš„å­£ç¯€æ°£å€™ã€‚", npcWin: "å­«æ­¦ï¼šã€ŒçŸ¥å¤©æ™‚è€…ï¼Œå¯å€Ÿé¢¨é›¨ä¹‹åŠ›ã€‚ã€" },
            { segments: ["åœ°è€…", "é è¿‘", "éšªæ˜“", "å»£ç‹¹", "æ­»ç”Ÿä¹Ÿ"], translation: "ã€ç™½è©±ã€‘æ‰€è¬‚ã€Œåœ°ã€ï¼Œæ˜¯æŒ‡è·¯ç¨‹çš„é è¿‘ã€åœ°å‹¢çš„éšªè¦æˆ–å¹³å¦ã€æˆ°å ´çš„å»£é—Šæˆ–ç‹¹çª„ï¼Œä»¥åŠåœ°å½¢æ˜¯çµ•åœ°é‚„æ˜¯ç”Ÿè·¯ã€‚", npcWin: "å­«æ­¦ï¼šã€Œåœ°åˆ©è€…ï¼Œå…µä¹‹åŠ©ä¹Ÿã€‚ã€" },
            { segments: ["å°‡è€…", "æ™º", "ä¿¡", "ä»", "å‹‡", "åš´ä¹Ÿ"], translation: "ã€ç™½è©±ã€‘æ‰€è¬‚ã€Œå°‡ã€ï¼Œå°±æ˜¯å°‡é ˜è¦å…·å‚™æ™ºæ…§ã€èª ä¿¡ã€ä»æ„›ã€å‹‡æ•¢ã€åš´æ˜é€™äº”ç¨®ç´ è³ªã€‚", npcWin: "å­«æ­¦ï¼šã€Œç‚ºå°‡è€…ï¼Œç•¶å…·å‚™æ­¤äº”å¾·ã€‚ã€" },
            { segments: ["æ³•è€…", "æ›²åˆ¶", "å®˜é“", "ä¸»ç”¨ä¹Ÿ"], translation: "ã€ç™½è©±ã€‘æ‰€è¬‚ã€Œæ³•ã€ï¼Œæ˜¯æŒ‡è»éšŠçš„çµ„ç¹”ç·¨åˆ¶ã€å°‡åçš„è·è²¬ç®¡ç†ã€ä»¥åŠè»éœ€ç‰©è³‡çš„ä¾›æ‡‰ç®¡ç†ã€‚", npcWin: "å­«æ­¦ï¼šã€Œæ³•åˆ¶ä¸æ˜ï¼Œå‰‡è»ä»¤ä¸è¡Œã€‚ã€" }
        ];

        let currentLevel = 0;
        let currentSelection = [];
        let pool = [];
        let isHintOn = true;

        const targetZone = document.getElementById('target-zone');
        const sourceZone = document.getElementById('source-zone');
        const hintText = document.getElementById('hint-text');
        const npcText = document.getElementById('npc-text');
        const levelIndicator = document.getElementById('level-indicator');
        const progressBar = document.getElementById('progress-bar');
        const winModal = document.getElementById('win-modal');
        const modalContent = document.getElementById('modal-content');
        const hintToggle = document.getElementById('hint-toggle');
        const checkBtn = document.getElementById('check-answer-btn');
        const resetBtn = document.getElementById('reset-btn');

        function initGame() { loadLevel(currentLevel); }
        function toggleHint() { isHintOn = hintToggle.checked; updateHintEffect(); updateNpcText(); }

        function updateNpcText() {
            if (checkBtn.style.display === 'block') return; // éé—œå¾Œä¸æ›´æ–°
            npcText.innerText = isHintOn ? "å­«æ­¦ï¼šã€Œä¾ç«¹ç°¡å…‰èŠ’ï¼Œä½ˆä¸‹é™£å‹¢ã€‚ã€" : "å­«æ­¦ï¼šã€Œæˆ°å ´ç„¡æƒ…ï¼Œå…¨æ†‘å°‡è»æ±ºæ–·ï¼ã€";
            npcText.style.color = "#000";
        }

        function loadLevel(idx) {
            currentSelection = [];
            pool = [...levels[idx].segments].sort(() => Math.random() - 0.5);

            levelIndicator.innerText = `é—œå¡ ${idx + 1}/${levels.length}`;
            progressBar.style.width = `${((idx) / levels.length) * 100}%`;
            
            checkBtn.style.display = 'none'; 
            resetBtn.style.display = 'block'; 
            winModal.style.display = 'none';

            // é‡ç½®æ¨£å¼
            document.querySelector('.target-zone-wrapper').style.borderColor = "#3e2723";
            npcText.innerText = "...";

            setTimeout(() => {
                renderBoard();
                npcText.innerText = isHintOn ? "å­«æ­¦ï¼šã€Œä¾ç«¹ç°¡å…‰èŠ’ï¼Œä½ˆä¸‹é™£å‹¢ã€‚ã€" : "å­«æ­¦ï¼šã€Œæˆ°å ´ç„¡æƒ…ï¼Œå…¨æ†‘å°‡è»æ±ºæ–·ï¼ã€";
            }, 50);
        }

        function renderBoard() {
            targetZone.innerHTML = '';
            if (currentSelection.length === 0) targetZone.appendChild(hintText);
            else currentSelection.forEach((text, i) => targetZone.appendChild(createBamboo(text, 'target', i)));

            sourceZone.innerHTML = '';
            pool.forEach((text, i) => {
                const btn = createBamboo(text, 'source', i);
                btn.setAttribute('data-text', text);
                sourceZone.appendChild(btn);
            });
            updateHintEffect();
        }

        function updateHintEffect() {
            const allBtns = sourceZone.querySelectorAll('.bamboo-slip');
            allBtns.forEach(btn => btn.classList.remove('hint-active'));
            if (!isHintOn) return;

            const data = levels[currentLevel];
            if (currentSelection.length >= data.segments.length) return;
            const nextText = data.segments[currentSelection.length];

            for(let btn of allBtns) {
                if (btn.getAttribute('data-text') === nextText) {
                    btn.classList.add('hint-active');
                    break;
                }
            }
        }

        function createBamboo(text, type, index) {
            if (checkBtn.style.display === 'block') return document.createElement('div'); // éé—œå¾Œå›å‚³ç©ºdiv

            const btn = document.createElement('div');
            btn.className = 'bamboo-slip';
            btn.innerText = text;
            btn.onclick = function() {
                if (navigator.vibrate) navigator.vibrate(15);
                if (type === 'source') {
                    currentSelection.push(text);
                    pool.splice(pool.indexOf(text), 1);
                } else {
                    pool.push(text);
                    currentSelection.splice(currentSelection.indexOf(text), 1);
                }
                renderBoard();
                checkWin();
            };
            return btn;
        }

        function checkWin() {
            const data = levels[currentLevel];
            if (currentSelection.length !== data.segments.length) return;

            const isCorrect = currentSelection.every((val, i) => val === data.segments[i]);

            if (isCorrect) {
                npcText.innerText = data.npcWin;
                npcText.style.color = "#b71c1c";
                document.querySelector('.target-zone-wrapper').style.borderColor = "#2e7d32";
                checkBtn.style.display = 'block';
                resetBtn.style.display = 'none';
            } else {
                npcText.innerText = "å­«æ­¦ï¼šã€Œé™£å‹¢å·²äº‚ï¼è«‹é‡æ•´æ——é¼“ã€‚ã€";
            }
        }

        function showModal() {
             const data = levels[currentLevel];
             modalContent.innerHTML = `<strong>${data.segments.join('ï¼Œ')}</strong><br><br>${data.translation}`;
             winModal.style.display = 'flex';
        }

        function nextLevel() {
            currentLevel++;
            if (currentLevel >= levels.length) { alert("æ­å–œå°‡è»ï¼å§‹è¨ˆç¯‡ä¿®ç·´å®Œç•¢ï¼"); currentLevel = 0; }
            loadLevel(currentLevel);
        }

        function replayLevel() { loadLevel(currentLevel); }
        function resetCurrentLevel() { loadLevel(currentLevel); }
    </script>
</body>
</html>
